<div class="max-w-6xl mx-auto py-12 px-4">
  <!-- Header -->
  <div class="text-center mb-16">
    <h1 class="text-5xl font-extrabold text-gray-900 dark:text-white mb-4">Documentation</h1>
    <p class="text-xl text-gray-600 dark:text-gray-400">Everything you need to integrate Inslash into your application
    </p>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
    <!-- Sidebar Navigation -->
    <div class="lg:col-span-1">
      <nav class="sticky top-20 space-y-6">
        <div>
          <h3 class="px-3 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">Getting
            Started</h3>
          <a href="#getting-started"
            class="block px-3 py-2 rounded-md text-sm font-medium text-indigo-600 dark:text-indigo-400 bg-indigo-50 dark:bg-indigo-900/20">Getting
            Started</a>
          <a href="#integration"
            class="block px-3 py-2 rounded-md text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-800">Integration</a>
          <a href="#features"
            class="block px-3 py-2 rounded-md text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-800">Features</a>
        </div>

        <div>
          <h3 class="px-3 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">API
            Reference</h3>
          <a href="#hash"
            class="block px-3 py-2 rounded-md text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-800">hash()</a>
          <a href="#verify"
            class="block px-3 py-2 rounded-md text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-800">verify()</a>
          <a href="#batch-verify"
            class="block px-3 py-2 rounded-md text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-800">batchVerify()</a>
          <a href="#inspect-passport"
            class="block px-3 py-2 rounded-md text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-800">inspectPassport()</a>
          <a href="#compare-passports"
            class="block px-3 py-2 rounded-md text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-800">comparePassports()</a>
          <a href="#estimate-security"
            class="block px-3 py-2 rounded-md text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-800">estimateSecurity()</a>
          <a href="#generate-api-key"
            class="block px-3 py-2 rounded-md text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-800">generateApiKey()</a>
          <a href="#derive-key"
            class="block px-3 py-2 rounded-md text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-800">deriveKey()</a>
          <a href="#configuration"
            class="block px-3 py-2 rounded-md text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-800">Configuration</a>
        </div>

        <div>
          <h3 class="px-3 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">Security
            Presets</h3>
          <a href="#security-presets"
            class="block px-3 py-2 rounded-md text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-800">Presets</a>
        </div>
        <a href="#example-auth"
          class="block px-3 py-2 rounded-md text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-800">Authentication
          System</a>
        <a href="#example-registration"
          class="block px-3 py-2 rounded-md text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-800">User
          Registration</a>
        <a href="#example-reset"
          class="block px-3 py-2 rounded-md text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-800">Password
          Reset</a>
    </div>
    </nav>
  </div>

  <!-- Content -->
  <div class="lg:col-span-3 space-y-16">

    <!-- Getting Started (API Key) -->
    <section id="getting-started" class="scroll-mt-24">
      <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-6">1. Get Your Credentials</h2>
      <p class="text-gray-600 dark:text-gray-400 mb-4">Before using Inslash, you need an API key to access our secure
        hashing infrastructure.</p>

      <div class="bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700 p-6">
        <ol class="list-decimal list-inside text-gray-600 dark:text-gray-400 space-y-4">
          <li class="pl-2"><span class="font-medium text-gray-900 dark:text-white">Sign Up:</span> Create an account
            at <a href="https://inslash-q5s6.vercel.app"
              class="text-indigo-600 hover:underline">inslash-q5s6.vercel.app</a></li>
          <li class="pl-2"><span class="font-medium text-gray-900 dark:text-white">Get API Key:</span> Navigate to the
            <strong>API Keys</strong> section in your dashboard.
          </li>
          <li class="pl-2"><span class="font-medium text-gray-900 dark:text-white">Save It:</span> Copy the key
            (starts with <code>sk_</code>) - you'll need it for the next step.</li>
        </ol>
      </div>
    </section>

    <!-- Integration Toggles -->
    <section id="integration" class="scroll-mt-24" x-data="{ mode: 'library' }">
      <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-6">2. Choose Integration</h2>

      <!-- Mode Toggle -->
      <div class="flex p-1 space-x-1 bg-gray-100 dark:bg-gray-800 rounded-xl mb-8 w-fit">
        <button @click="mode = 'library'"
          class="px-6 py-2.5 text-sm font-medium rounded-lg transition-all duration-200 focus:outline-none"
          :class="mode === 'library' ? 'bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm' : 'text-gray-500 hover:text-gray-700 dark:hover:text-gray-300'">
          Integration via Library
        </button>
        <button @click="mode = 'api'"
          class="px-6 py-2.5 text-sm font-medium rounded-lg transition-all duration-200 focus:outline-none"
          :class="mode === 'api' ? 'bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm' : 'text-gray-500 hover:text-gray-700 dark:hover:text-gray-300'">
          Integration via API
        </button>
      </div>

      <!-- LIBRARY MODE -->
      <div x-show="mode === 'library'" x-transition:enter="transition ease-out duration-200"
        x-transition:enter-start="opacity-0 translate-y-2" x-transition:enter-end="opacity-100 translate-y-0">
        <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">Option A: Node.js Library (Recommended)
        </h3>
        <p class="text-gray-600 dark:text-gray-400 mb-6">Best for Node.js applications. Provides type safety,
          automatic fallback, and utility helpers.</p>

        <div class="mb-8">
          <h4 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2">Installation</h4>
          <div
            class="bg-gray-900 dark:bg-gray-950 text-gray-300 p-4 rounded-lg font-mono text-sm border border-gray-800">
            npm install inslash
          </div>
        </div>

        <div>
          <h4 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2">Usage</h4>
          <div class="code-block-wrapper relative group my-4">
            <div
              class="bg-gray-900 dark:bg-gray-950 text-gray-300 p-6 rounded-lg font-mono text-sm border border-gray-800 overflow-x-auto">
              <button onclick="copyCodeBlock(this)"
                class="absolute top-4 right-4 px-3 py-1.5 bg-gray-800 hover:bg-gray-700 text-gray-300 text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-2">
                <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z">
                  </path>
                </svg>
                <span class="copy-text">Copy</span>
              </button>
              <pre><code class="language-javascript">const inslash = require('inslash');

// Configuration
inslash.configure({
    apiKey: 'sk_test_51Mz...', 
    apiUrl: 'https://inslash-q5s6.vercel.app'
});

const { hash } = inslash;

async function example() {
    // Hash password (using API with local fallback)
    const { passport } = await hash('password123', 'your-pepper-secret');
    
    // Store passport in DB
    console.log(passport); 
}</code></pre>
            </div>
          </div>
        </div>
      </div>

      <!-- API MODE -->
      <div x-show="mode === 'api'" x-transition:enter="transition ease-out duration-200"
        x-transition:enter-start="opacity-0 translate-y-2" x-transition:enter-end="opacity-100 translate-y-0"
        style="display: none;">
        <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">Option B: REST API</h3>
        <p class="text-gray-600 dark:text-gray-400 mb-6">Best for non-Node.js environments (Python, Go, PHP) or
          serverless functions.</p>

        <div class="grid gap-4 mb-8">
          <div class="p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700">
            <div class="flex items-center justify-between mb-2">
              <code class="text-sm font-bold text-indigo-600 dark:text-indigo-400">POST /api/hash</code>
              <span
                class="px-2 py-1 text-xs rounded-full bg-indigo-100 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300">Hash
                Password</span>
            </div>
            <p class="text-sm text-gray-600 dark:text-gray-400">Generates a secure hash (passport).</p>
          </div>
          <div class="p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700">
            <div class="flex items-center justify-between mb-2">
              <code class="text-sm font-bold text-indigo-600 dark:text-indigo-400">POST /api/verify</code>
              <span
                class="px-2 py-1 text-xs rounded-full bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300">Verify
                Password</span>
            </div>
            <p class="text-sm text-gray-600 dark:text-gray-400">Verifies a password against a passport.</p>
          </div>

          <!-- Key Management Endpoints -->
          <div class="p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700">
            <h4
              class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3 pb-2 border-b border-gray-200 dark:border-gray-700">
              Key Management</h4>
            <div class="flex flex-col gap-3">
              <div class="flex items-center justify-between">
                <code class="text-sm font-bold text-gray-600 dark:text-gray-400">GET /api/keys</code>
                <span class="text-xs text-gray-500">List API Keys</span>
              </div>
              <div class="flex items-center justify-between">
                <code class="text-sm font-bold text-gray-600 dark:text-gray-400">POST /api/keys/create</code>
                <span class="text-xs text-gray-500">Create Key</span>
              </div>
              <div class="flex items-center justify-between">
                <code class="text-sm font-bold text-gray-600 dark:text-gray-400">POST /api/keys/:id/revoke</code>
                <span class="text-xs text-gray-500">Revoke Key</span>
              </div>
            </div>
          </div>
        </div>

        <div>
          <h4 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2">Example Request
            (JavaScript/Fetch)</h4>
          <div class="code-block-wrapper relative group my-4">
            <div
              class="bg-gray-900 dark:bg-gray-950 text-gray-300 p-6 rounded-lg font-mono text-sm border border-gray-800 overflow-x-auto">
              <button onclick="copyCodeBlock(this)"
                class="absolute top-4 right-4 px-3 py-1.5 bg-gray-800 hover:bg-gray-700 text-gray-300 text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-2">
                <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z">
                  </path>
                </svg>
                <span class="copy-text">Copy</span>
              </button>
              <pre><code class="language-javascript">const response = await fetch('https://inslash-q5s6.vercel.app/api/hash', {
  method: 'POST',
  headers: {
    'x-api-key': 'sk_test_...', // Your API Key
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    value: 'userPassword123',
    secret: 'your_pepper_secret'
  })
});

const { passport } = await response.json();</code></pre>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Features -->
    <section id="features" class="scroll-mt-24">
      <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-6">Features</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="p-6 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700">
          <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">üîê Multiple Algorithms</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm">Support for SHA-256, SHA-384, and SHA-512 HMAC
            algorithms</p>
        </div>
        <div class="p-6 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700">
          <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">üé´ Passport Encoding</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm">All metadata encoded in a single string for easy storage
          </p>
        </div>
        <div class="p-6 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700">
          <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">‚ö° Automatic Upgrades</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm">Detects when hashes need upgrading to stronger
            algorithms</p>
        </div>
        <div class="p-6 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700">
          <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">üõ°Ô∏è Timing-Safe</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm">Protection against timing attacks with constant-time
            comparison</p>
        </div>
      </div>
    </section>

    <!-- API Reference - hash() -->
    <section id="hash" class="scroll-mt-24">
      <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-6">hash(value, secret, options)</h2>
      <p class="text-gray-600 dark:text-gray-400 mb-4">Creates a secure hash of a password.</p>

      <%- include('partials/parameter-table', { parameters: [ { name: 'value' , type: 'string' , required: true,
        description: 'The password to hash' }, { name: 'secret' , type: 'string' , required: true,
        description: 'Secret key (pepper) for additional security' }, { name: 'options' , type: 'object' , required:
        false, description: 'Configuration options' } ] }) %>

        <h3 class="text-xl font-semibold text-gray-900 dark:text-white mt-6 mb-3">Options</h3>
        <%- include('partials/parameter-table', { parameters: [ { name: 'algorithm' , type: 'string' , required: false,
          description: 'Hash algorithm: "sha256", "sha384", or "sha512" (default: "sha256")' }, { name: 'iterations' ,
          type: 'number' , required: false, description: 'Number of iterations (default: 100,000)' }, {
          name: 'saltLength' , type: 'number' , required: false, description: 'Length of salt in bytes (default: 16)' },
          { name: 'hashLength' , type: 'number' , required: false, description: 'Length of hash in bytes (default: 32)'
          } ] }) %>

          <h3 class="text-xl font-semibold text-gray-900 dark:text-white mt-6 mb-3">Returns</h3>
          <p class="text-gray-600 dark:text-gray-400 mb-2">Object containing:</p>
          <ul class="list-disc list-inside text-gray-600 dark:text-gray-400 space-y-1 ml-4">
            <li><code class="text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">passport</code> - Encoded string
              to store in database</li>
            <li><code class="text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">hash</code> - The raw hash value
            </li>
            <li><code class="text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">salt</code> - The generated salt
            </li>
            <li><code class="text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">metadata</code> - Algorithm,
              iterations, etc.</li>
          </ul>
    </section>

    <!-- API Reference - verify() -->
    <section id="verify" class="scroll-mt-24">
      <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-6">verify(value, passport, secret, options)</h2>
      <p class="text-gray-600 dark:text-gray-400 mb-4">Verifies a password against a stored passport.</p>

      <%- include('partials/parameter-table', { parameters: [ { name: 'value' , type: 'string' , required: true,
        description: 'The password to verify' }, { name: 'passport' , type: 'string' , required: true,
        description: 'The stored passport from hash()' }, { name: 'secret' , type: 'string' , required: true,
        description: 'Same secret key used for hashing' }, { name: 'options' , type: 'object' , required: false,
        description: 'Upgrade configuration' } ] }) %>

        <h3 class="text-xl font-semibold text-gray-900 dark:text-white mt-6 mb-3">Returns</h3>
        <p class="text-gray-600 dark:text-gray-400 mb-2">Object containing:</p>
        <ul class="list-disc list-inside text-gray-600 dark:text-gray-400 space-y-1 ml-4">
          <li><code class="text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">valid</code> - Boolean indicating
            if password is correct</li>
          <li><code class="text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">needsUpgrade</code> - Boolean
            indicating if hash should be upgraded</li>
          <li><code class="text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">upgradedPassport</code> - New
            passport if upgrade needed</li>
          <li><code class="text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">metadata</code> - Current hash
            metadata</li>
        </ul>
    </section>

    <!-- ‚îÄ‚îÄ NEW: Security Presets ‚îÄ‚îÄ -->
    <section id="security-presets" class="scroll-mt-24">
      <div class="flex items-center gap-3 mb-6">
        <h2 class="text-3xl font-bold text-gray-900 dark:text-white">Security Presets</h2>
        <span
          class="px-2 py-0.5 text-xs font-bold bg-indigo-100 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 rounded">v2.0</span>
      </div>
      <p class="text-gray-600 dark:text-gray-400 mb-6">Use named presets instead of tuning options manually. Presets map
        to battle-tested option sets.</p>
      <div class="overflow-x-auto mb-6">
        <table class="w-full text-left text-sm border border-gray-200 dark:border-gray-800 rounded-lg overflow-hidden">
          <thead class="bg-gray-50 dark:bg-gray-900">
            <tr>
              <th class="px-4 py-3 font-semibold text-gray-900 dark:text-white">Preset</th>
              <th class="px-4 py-3 font-semibold text-gray-700 dark:text-gray-300">Algorithm</th>
              <th class="px-4 py-3 font-semibold text-gray-700 dark:text-gray-300">Iterations</th>
              <th class="px-4 py-3 font-semibold text-gray-700 dark:text-gray-300">Salt</th>
              <th class="px-4 py-3 font-semibold text-gray-700 dark:text-gray-300">Hash</th>
              <th class="px-4 py-3 font-semibold text-gray-700 dark:text-gray-300">Use Case</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-200 dark:divide-gray-800">
            <tr>
              <td class="px-4 py-3 font-mono text-indigo-600 dark:text-indigo-400">fast</td>
              <td class="px-4 py-3 text-gray-600 dark:text-gray-400">sha256</td>
              <td class="px-4 py-3 text-gray-600 dark:text-gray-400">50,000</td>
              <td class="px-4 py-3 text-gray-600 dark:text-gray-400">16</td>
              <td class="px-4 py-3 text-gray-600 dark:text-gray-400">32</td>
              <td class="px-4 py-3 text-gray-500 text-xs">Dev / low-stakes</td>
            </tr>
            <tr>
              <td class="px-4 py-3 font-mono text-indigo-600 dark:text-indigo-400">balanced</td>
              <td class="px-4 py-3 text-gray-600 dark:text-gray-400">sha256</td>
              <td class="px-4 py-3 text-gray-600 dark:text-gray-400">100,000</td>
              <td class="px-4 py-3 text-gray-600 dark:text-gray-400">16</td>
              <td class="px-4 py-3 text-gray-600 dark:text-gray-400">32</td>
              <td class="px-4 py-3 text-gray-500 text-xs">Default / general use</td>
            </tr>
            <tr class="bg-green-50 dark:bg-green-900/10">
              <td class="px-4 py-3 font-mono text-green-600 dark:text-green-400">strong ‚òÖ</td>
              <td class="px-4 py-3 text-gray-600 dark:text-gray-400">sha384</td>
              <td class="px-4 py-3 text-gray-600 dark:text-gray-400">200,000</td>
              <td class="px-4 py-3 text-gray-600 dark:text-gray-400">24</td>
              <td class="px-4 py-3 text-gray-600 dark:text-gray-400">48</td>
              <td class="px-4 py-3 text-gray-500 text-xs">Recommended for production</td>
            </tr>
            <tr>
              <td class="px-4 py-3 font-mono text-indigo-600 dark:text-indigo-400">paranoid</td>
              <td class="px-4 py-3 text-gray-600 dark:text-gray-400">sha512</td>
              <td class="px-4 py-3 text-gray-600 dark:text-gray-400">400,000</td>
              <td class="px-4 py-3 text-gray-600 dark:text-gray-400">32</td>
              <td class="px-4 py-3 text-gray-600 dark:text-gray-400">64</td>
              <td class="px-4 py-3 text-gray-500 text-xs">High-security / financial</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="code-block-wrapper relative group my-4">
        <div
          class="bg-gray-900 dark:bg-gray-950 text-gray-300 p-6 rounded-lg font-mono text-sm border border-gray-800 overflow-x-auto">
          <button onclick="copyCodeBlock(this)"
            class="absolute top-4 right-4 px-3 py-1.5 bg-gray-800 hover:bg-gray-700 text-gray-300 text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-2">
            <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z">
              </path>
            </svg>
            <span class="copy-text">Copy</span>
          </button>
          <pre><code class="language-javascript">const { hash, SECURITY_PRESETS } = require('inslash');

// Use a named preset
const result = await hash('myPassword', secret, { preset: 'strong' });

// Or access preset values directly
console.log(SECURITY_PRESETS.paranoid);
// { iterations: 400000, saltLength: 32, hashLength: 64, algorithm: 'sha512' }</code></pre>
        </div>
      </div>
    </section>

    <!-- ‚îÄ‚îÄ NEW: batchVerify() ‚îÄ‚îÄ -->
    <section id="batch-verify" class="scroll-mt-24">
      <div class="flex items-center gap-3 mb-6">
        <h2 class="text-3xl font-bold text-gray-900 dark:text-white">batchVerify(values, passport, secret, options?)
        </h2>
        <span
          class="px-2 py-0.5 text-xs font-bold bg-indigo-100 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 rounded">v2.0</span>
      </div>
      <p class="text-gray-600 dark:text-gray-400 mb-4">Verify multiple values against the same passport. Runs with
        concurrency control to avoid CPU starvation.</p>
      <%- include('partials/parameter-table', { parameters: [ { name: 'values' , type: 'string[]' , required: true,
        description: 'Array of values to verify (max 50 per API call)' }, { name: 'passport' , type: 'string' ,
        required: true, description: 'The stored passport from hash()' }, { name: 'secret' , type: 'string' , required:
        true, description: 'Same secret key used for hashing' }, { name: 'options.concurrency' , type: 'number' ,
        required: false, description: 'Max parallel verifications (default: 4)' } ] }) %>
        <h3 class="text-xl font-semibold text-gray-900 dark:text-white mt-6 mb-3">Returns</h3>
        <p class="text-gray-600 dark:text-gray-400 mb-2">Array of result objects, each containing:</p>
        <ul class="list-disc list-inside text-gray-600 dark:text-gray-400 space-y-1 ml-4">
          <li><code class="text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">value</code> ‚Äî the input value</li>
          <li><code class="text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">valid</code> ‚Äî boolean</li>
          <li><code class="text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">needsUpgrade</code> ‚Äî boolean</li>
          <li><code class="text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">error</code> ‚Äî string (if that value
            failed)</li>
        </ul>
        <div class="code-block-wrapper relative group my-4">
          <div
            class="bg-gray-900 dark:bg-gray-950 text-gray-300 p-6 rounded-lg font-mono text-sm border border-gray-800 overflow-x-auto">
            <button onclick="copyCodeBlock(this)"
              class="absolute top-4 right-4 px-3 py-1.5 bg-gray-800 hover:bg-gray-700 text-gray-300 text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-2">
              <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z">
                </path>
              </svg>
              <span class="copy-text">Copy</span>
            </button>
            <pre><code class="language-javascript">const { batchVerify } = require('inslash');

const results = await batchVerify(
    ['guess1', 'guess2', 'correctPassword'],
    storedPassport,
    secret,
    { concurrency: 4 }
);
// [{ value: 'guess1', valid: false }, { value: 'correctPassword', valid: true, needsUpgrade: false }]</code></pre>
          </div>
        </div>
    </section>

    <!-- ‚îÄ‚îÄ NEW: inspectPassport() ‚îÄ‚îÄ -->
    <section id="inspect-passport" class="scroll-mt-24">
      <div class="flex items-center gap-3 mb-6">
        <h2 class="text-3xl font-bold text-gray-900 dark:text-white">inspectPassport(passport)</h2>
        <span
          class="px-2 py-0.5 text-xs font-bold bg-indigo-100 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 rounded">v2.0</span>
      </div>
      <p class="text-gray-600 dark:text-gray-400 mb-4">Decode a passport and read its metadata without verifying. Useful
        for auditing, debugging, and admin tooling.</p>
      <%- include('partials/parameter-table', { parameters: [ { name: 'passport' , type: 'string' , required: true,
        description: 'The passport string to inspect' } ] }) %>
        <h3 class="text-xl font-semibold text-gray-900 dark:text-white mt-6 mb-3">Returns</h3>
        <ul class="list-disc list-inside text-gray-600 dark:text-gray-400 space-y-1 ml-4">
          <li><code class="text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">valid</code> ‚Äî boolean (false if
            passport is malformed)</li>
          <li><code
              class="text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">version, algorithm, iterations, saltLength, hashLength, encoding</code>
          </li>
          <li><code class="text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">history</code> ‚Äî full upgrade audit
            trail</li>
        </ul>
        <div class="code-block-wrapper relative group my-4">
          <div
            class="bg-gray-900 dark:bg-gray-950 text-gray-300 p-6 rounded-lg font-mono text-sm border border-gray-800 overflow-x-auto">
            <button onclick="copyCodeBlock(this)"
              class="absolute top-4 right-4 px-3 py-1.5 bg-gray-800 hover:bg-gray-700 text-gray-300 text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-2">
              <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z">
                </path>
              </svg>
              <span class="copy-text">Copy</span>
            </button>
            <pre><code class="language-javascript">const { inspectPassport } = require('inslash');

const info = inspectPassport(storedPassport);
console.log(info.algorithm);  // 'sha384'
console.log(info.iterations); // 200000
console.log(info.history);    // [{ date, algorithm, event }]</code></pre>
          </div>
        </div>
    </section>

    <!-- ‚îÄ‚îÄ NEW: comparePassports() ‚îÄ‚îÄ -->
    <section id="compare-passports" class="scroll-mt-24">
      <div class="flex items-center gap-3 mb-6">
        <h2 class="text-3xl font-bold text-gray-900 dark:text-white">comparePassports(passport1, passport2)</h2>
        <span
          class="px-2 py-0.5 text-xs font-bold bg-indigo-100 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 rounded">v2.0</span>
      </div>
      <p class="text-gray-600 dark:text-gray-400 mb-4">Structurally compare two passports. Does <strong>not</strong>
        verify plaintext ‚Äî only compares encoded metadata and hash values.</p>
      <h3 class="text-xl font-semibold text-gray-900 dark:text-white mt-6 mb-3">Returns</h3>
      <ul class="list-disc list-inside text-gray-600 dark:text-gray-400 space-y-1 ml-4">
        <li><code
            class="text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">sameAlgorithm, sameIterations, sameEncoding, sameSalt, sameHash</code>
          ‚Äî booleans</li>
        <li><code class="text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">identical</code> ‚Äî true when both hash
          AND salt match (same passport)</li>
      </ul>
      <div class="code-block-wrapper relative group my-4">
        <div
          class="bg-gray-900 dark:bg-gray-950 text-gray-300 p-6 rounded-lg font-mono text-sm border border-gray-800 overflow-x-auto">
          <button onclick="copyCodeBlock(this)"
            class="absolute top-4 right-4 px-3 py-1.5 bg-gray-800 hover:bg-gray-700 text-gray-300 text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-2">
            <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z">
              </path>
            </svg>
            <span class="copy-text">Copy</span>
          </button>
          <pre><code class="language-javascript">const { comparePassports } = require('inslash');

const cmp = comparePassports(passportA, passportB);
console.log(cmp.sameAlgorithm); // true
console.log(cmp.identical);     // false (different salts)</code></pre>
        </div>
      </div>
    </section>

    <!-- ‚îÄ‚îÄ NEW: estimateSecurity() ‚îÄ‚îÄ -->
    <section id="estimate-security" class="scroll-mt-24">
      <div class="flex items-center gap-3 mb-6">
        <h2 class="text-3xl font-bold text-gray-900 dark:text-white">estimateSecurity(passport)</h2>
        <span
          class="px-2 py-0.5 text-xs font-bold bg-indigo-100 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 rounded">v2.0</span>
      </div>
      <p class="text-gray-600 dark:text-gray-400 mb-4">Score a passport's security strength (0‚Äì100) and get actionable
        recommendations.</p>
      <div class="bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700 p-5 mb-6">
        <h4 class="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3">Scoring Methodology</h4>
        <div class="grid grid-cols-2 gap-3 text-sm text-gray-600 dark:text-gray-400">
          <div>Algorithm: sha256=25, sha384=35, sha512=40</div>
          <div>Iterations: ‚â•400k=35, ‚â•200k=28, ‚â•100k=20, ‚â•50k=12</div>
          <div>Salt length: ‚â•32=15, ‚â•16=10</div>
          <div>Hash length: ‚â•64=10, ‚â•32=7</div>
          <div class="col-span-2">Upgrade history bonus: +5 (shows active maintenance)</div>
        </div>
      </div>
      <h3 class="text-xl font-semibold text-gray-900 dark:text-white mt-6 mb-3">Returns</h3>
      <ul class="list-disc list-inside text-gray-600 dark:text-gray-400 space-y-1 ml-4">
        <li><code class="text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">score</code> ‚Äî 0‚Äì100</li>
        <li><code class="text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">level</code> ‚Äî Excellent / Strong /
          Good / Fair / Weak / Critical / Invalid</li>
        <li><code class="text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">recommendations</code> ‚Äî string[] of
          actionable improvements</li>
        <li><code class="text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">metadata</code> ‚Äî algorithm,
          iterations, saltLength, hashLength</li>
      </ul>
      <div class="code-block-wrapper relative group my-4">
        <div
          class="bg-gray-900 dark:bg-gray-950 text-gray-300 p-6 rounded-lg font-mono text-sm border border-gray-800 overflow-x-auto">
          <button onclick="copyCodeBlock(this)"
            class="absolute top-4 right-4 px-3 py-1.5 bg-gray-800 hover:bg-gray-700 text-gray-300 text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-2">
            <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z">
              </path>
            </svg>
            <span class="copy-text">Copy</span>
          </button>
          <pre><code class="language-javascript">const { estimateSecurity } = require('inslash');

const { score, level, recommendations } = estimateSecurity(storedPassport);
console.log(score);           // 78
console.log(level);           // 'Strong'
console.log(recommendations); // ['Consider upgrading to sha512']</code></pre>
        </div>
      </div>
    </section>

    <!-- ‚îÄ‚îÄ NEW: generateApiKey() ‚îÄ‚îÄ -->
    <section id="generate-api-key" class="scroll-mt-24">
      <div class="flex items-center gap-3 mb-6">
        <h2 class="text-3xl font-bold text-gray-900 dark:text-white">generateApiKey(options?)</h2>
        <span
          class="px-2 py-0.5 text-xs font-bold bg-indigo-100 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 rounded">v2.0</span>
      </div>
      <p class="text-gray-600 dark:text-gray-400 mb-4">Generate a cryptographically secure API key. Useful for
        generating tokens, secrets, or session keys.</p>
      <%- include('partials/parameter-table', { parameters: [ { name: 'prefix' , type: 'string' , required: false,
        description: 'Key prefix (default: "inslash")' }, { name: 'byteLength' , type: 'number' , required: false,
        description: 'Random bytes to generate (default: 32)' }, { name: 'encoding' , type: 'string' , required: false,
        description: '"hex" | "base64" | "base64url" (default: "hex")' } ] }) %>
        <div class="code-block-wrapper relative group my-4">
          <div
            class="bg-gray-900 dark:bg-gray-950 text-gray-300 p-6 rounded-lg font-mono text-sm border border-gray-800 overflow-x-auto">
            <button onclick="copyCodeBlock(this)"
              class="absolute top-4 right-4 px-3 py-1.5 bg-gray-800 hover:bg-gray-700 text-gray-300 text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-2">
              <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z">
                </path>
              </svg>
              <span class="copy-text">Copy</span>
            </button>
            <pre><code class="language-javascript">const { generateApiKey } = require('inslash');

const key = generateApiKey({ prefix: 'myapp', byteLength: 32 });
console.log(key); // 'myapp_a3f9b2c1...'</code></pre>
          </div>
        </div>
    </section>

    <!-- ‚îÄ‚îÄ NEW: deriveKey() ‚îÄ‚îÄ -->
    <section id="derive-key" class="scroll-mt-24">
      <div class="flex items-center gap-3 mb-6">
        <h2 class="text-3xl font-bold text-gray-900 dark:text-white">deriveKey(password, salt, opts?)</h2>
        <span
          class="px-2 py-0.5 text-xs font-bold bg-indigo-100 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 rounded">v2.0</span>
      </div>
      <p class="text-gray-600 dark:text-gray-400 mb-4">Derive a deterministic encryption key from a password using
        PBKDF2. Use this for <strong>symmetric encryption key derivation</strong>, not authentication.</p>
      <div class="bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-400 p-4 rounded-r-lg mb-6">
        <p class="text-sm text-yellow-700 dark:text-yellow-200"><strong>Note:</strong> Use <code>hash()</code> for
          password authentication. Use <code>deriveKey()</code> only when you need a deterministic key for encryption
          (e.g. AES-256).</p>
      </div>
      <%- include('partials/parameter-table', { parameters: [ { name: 'password' , type: 'string' , required: true,
        description: 'The password to derive from' }, { name: 'salt' , type: 'string' , required: true,
        description: 'Hex salt string' }, { name: 'opts.iterations' ,type: 'number' , required: false,
        description: 'PBKDF2 iterations (default: 200,000)' }, { name: 'opts.keyLength' , type: 'number' , required:
        false, description: 'Output key length in bytes (default: 32)' }, { name: 'opts.algorithm' , type: 'string' ,
        required: false, description: 'sha256 | sha384 | sha512 (default: sha512)' } ] }) %>
        <h3 class="text-xl font-semibold text-gray-900 dark:text-white mt-6 mb-3">Returns</h3>
        <p class="text-gray-600 dark:text-gray-400 mb-2"><code
            class="text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">Promise&lt;Buffer&gt;</code> ‚Äî the derived
          key as a Node.js Buffer.</p>
        <div class="code-block-wrapper relative group my-4">
          <div
            class="bg-gray-900 dark:bg-gray-950 text-gray-300 p-6 rounded-lg font-mono text-sm border border-gray-800 overflow-x-auto">
            <button onclick="copyCodeBlock(this)"
              class="absolute top-4 right-4 px-3 py-1.5 bg-gray-800 hover:bg-gray-700 text-gray-300 text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-2">
              <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z">
                </path>
              </svg>
              <span class="copy-text">Copy</span>
            </button>
            <pre><code class="language-javascript">const { deriveKey } = require('inslash');
const crypto = require('crypto');

const salt = crypto.randomBytes(16).toString('hex');
const keyBuffer = await deriveKey('userPassword', salt, {
    iterations: 200_000,
    keyLength: 32,       // 256-bit AES key
    algorithm: 'sha512'
});

// Use keyBuffer with AES-256-GCM for encryption</code></pre>
          </div>
        </div>
    </section>
    <section id="example-auth" class="scroll-mt-24">
      <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-6">Example: Complete Authentication System</h2>
      <p class="text-gray-600 dark:text-gray-400 mb-4">Full Express.js authentication with login, automatic upgrades,
        and session management:</p>
      <div class="code-block-wrapper relative group my-4">
        <div
          class="bg-gray-900 dark:bg-gray-950 text-gray-300 p-6 rounded-lg font-mono text-sm border border-gray-800 overflow-x-auto">
          <button onclick="copyCodeBlock(this)"
            class="absolute top-4 right-4 px-3 py-1.5 bg-gray-800 hover:bg-gray-700 text-gray-300 text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-2">
            <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z">
              </path>
            </svg>
            <span class="copy-text">Copy</span>
          </button>
          <pre><code class="language-javascript">const express = require('express');
const session = require('express-session');
const { hash, verify } = require('inslash');
const User = require('./models/User');

const app = express();
app.use(express.json());
app.use(session({
    secret: 'your-session-secret',
    resave: false,
    saveUninitialized: false
}));

// Login endpoint
app.post('/login', async (req, res) => {
    const { email, password } = req.body;

    // Find user
    const user = await User.findOne({ email });
    if (!user) {
        return res.status(401).json({ error: 'Invalid credentials' });
    }

    // Verify password
    const result = await verify(password, user.passport, process.env.HASH_PEPPER);

    if (!result.valid) {
        return res.status(401).json({ error: 'Invalid credentials' });
    }

    // Automatic security upgrade
    if (result.needsUpgrade) {
        user.passport = result.upgradedPassport;
        await user.save();
        console.log('Password hash upgraded for user:', user.email);
    }

    // Create session
    req.session.userId = user._id;
    res.json({ success: true, user: { id: user._id, email: user.email } });
});

// Protected route middleware
function requireAuth(req, res, next) {
    if (!req.session.userId) {
        return res.status(401).json({ error: 'Unauthorized' });
    }
    next();
}

app.get('/dashboard', requireAuth, (req, res) => {
    res.json({ message: 'Welcome to your dashboard!' });
});

app.listen(3000);</code></pre>
        </div>
      </div>
    </section>

    <!-- Example 2: User Registration -->
    <section id="example-registration" class="scroll-mt-24">
      <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-6">Example: User Registration Flow</h2>
      <p class="text-gray-600 dark:text-gray-400 mb-4">Complete user registration with validation and secure password
        storage:</p>
      <div class="code-block-wrapper relative group my-4">
        <div
          class="bg-gray-900 dark:bg-gray-950 text-gray-300 p-6 rounded-lg font-mono text-sm border border-gray-800 overflow-x-auto">
          <button onclick="copyCodeBlock(this)"
            class="absolute top-4 right-4 px-3 py-1.5 bg-gray-800 hover:bg-gray-700 text-gray-300 text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-2">
            <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z">
              </path>
            </svg>
            <span class="copy-text">Copy</span>
          </button>
          <pre><code class="language-javascript">const { hash } = require('inslash');
const User = require('./models/User');

app.post('/signup', async (req, res) => {
    const { username, email, password, confirmPassword } = req.body;

    // Validation
    if (!username || !email || !password) {
        return res.status(400).json({ error: 'All fields required' });
    }

    if (password !== confirmPassword) {
        return res.status(400).json({ error: 'Passwords do not match' });
    }

    if (password.length < 8) {
        return res.status(400).json({ error: 'Password must be at least 8 characters' });
    }

    // Check if user exists
    const existingUser = await User.findOne({ $or: [{ username }, { email }] });
    if (existingUser) {
        return res.status(400).json({ error: 'Username or email already exists' });
    }

    // Hash password with strong settings
    const hashResult = await hash(password, process.env.HASH_PEPPER, {
        algorithm: 'sha512',
        iterations: 150000
    });

    // Create user
    const user = new User({
        username,
        email,
        passport: hashResult.passport,
        createdAt: new Date()
    });

    await user.save();

    // Auto-login after registration
    req.session.userId = user._id;
    res.status(201).json({ success: true, user: { id: user._id, username: user.username, email: user.email } });
});</code></pre>
        </div>
      </div>
    </section>

    <!-- Example 3: Password Reset -->
    <section id="example-reset" class="scroll-mt-24">
      <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-6">Example: Password Reset System</h2>
      <p class="text-gray-600 dark:text-gray-400 mb-4">Secure password reset with email tokens:</p>
      <div class="code-block-wrapper relative group my-4">
        <div
          class="bg-gray-900 dark:bg-gray-950 text-gray-300 p-6 rounded-lg font-mono text-sm border border-gray-800 overflow-x-auto">
          <button onclick="copyCodeBlock(this)"
            class="absolute top-4 right-4 px-3 py-1.5 bg-gray-800 hover:bg-gray-700 text-gray-300 text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-2">
            <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z">
              </path>
            </svg>
            <span class="copy-text">Copy</span>
          </button>
          <pre><code class="language-javascript">const crypto = require('crypto');
const { hash } = require('inslash');
const User = require('./models/User');
const sendEmail = require('./utils/email');

// Request password reset
app.post('/forgot-password', async (req, res) => {
    const { email } = req.body;

    // Find user
    const user = await User.findOne({ email });
    if (!user) {
        // Don't reveal if email exists
        return res.json({ message: 'If email exists, reset link sent' });
    }

    // Generate reset token
    const resetToken = crypto.randomBytes(32).toString('hex');
    const resetTokenHash = crypto.createHash('sha256').update(resetToken).digest('hex');

    user.resetPasswordToken = resetTokenHash;
    user.resetPasswordExpires = Date.now() + 3600000; // 1 hour
    await user.save();

    // Send email
    const resetUrl = \`https://yourapp.com/reset-password/\${resetToken}\`;
    await sendEmail({
        to: user.email,
        subject: 'Password Reset Request',
        html: \`Click here to reset: <a href="\${resetUrl}">\${resetUrl}</a>\`
    });

    res.json({ message: 'If email exists, reset link sent' });
});

// Reset password with token
app.post('/reset-password/:token', async (req, res) => {
    const { password } = req.body;

    // Hash the token to compare
    const resetTokenHash = crypto.createHash('sha256')
        .update(req.params.token)
        .digest('hex');

    // Find user with valid token
    const user = await User.findOne({
        resetPasswordToken: resetTokenHash,
        resetPasswordExpires: { $gt: Date.now() }
    });

    if (!user) {
        return res.status(400).json({ error: 'Invalid or expired token' });
    }

    // Hash new password
    const hashResult = await hash(password, process.env.HASH_PEPPER, {
        algorithm: 'sha512',
        iterations: 150000
    });

    // Update user
    user.passport = hashResult.passport;
    user.resetPasswordToken = undefined;
    user.resetPasswordExpires = undefined;
    await user.save();

    res.json({ success: true, message: 'Password reset successful' });
});</code></pre>
        </div>
      </div>
    </section>

    <!-- Configuration -->
    <section id="configuration" class="scroll-mt-24">
      <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-6">Configuration</h2>
      <p class="text-gray-600 dark:text-gray-400 mb-4">Recommended security settings:</p>
      <div class="bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-400 p-4 rounded-r-lg mb-6">
        <div class="flex">
          <div class="flex-shrink-0">
            <svg class="h-5 w-5 text-yellow-400" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd"
                d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z"
                clip-rule="evenodd" />
            </svg>
          </div>
          <div class="ml-3">
            <p class="text-sm text-yellow-700 dark:text-yellow-200">
              <strong>Production Recommendation:</strong> Use SHA-512 with 150,000+ iterations for maximum security.
            </p>
          </div>
        </div>
      </div>

      <div class="code-block-wrapper relative group my-4">
        <div
          class="bg-gray-900 dark:bg-gray-950 text-gray-300 p-6 rounded-lg font-mono text-sm border border-gray-800 overflow-x-auto">
          <button onclick="copyCodeBlock(this)"
            class="absolute top-4 right-4 px-3 py-1.5 bg-gray-800 hover:bg-gray-700 text-gray-300 text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-2">
            <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z">
              </path>
            </svg>
            <span class="copy-text">Copy</span>
          </button>
          <pre><code class="language-javascript">// Production configuration
const productionConfig = {
    algorithm: 'sha512', // Strongest algorithm
    iterations: 150000, 
    saltLength: 16,     
    hashLength: 64      
};

// Use it
const result = await hash(password, process.env.HASH_PEPPER, productionConfig);</code></pre>
        </div>
      </div>
    </section>
  </div>
</div>
</div>